package tio

import (
	"fmt"

	"github.com/spf13/cobra"
	"github.com/whereiskurt/tio-cli/internal/app/tio/vulnerability"
)

//Cobra sub-command
var hostCmd = &cobra.Command{
	Aliases: []string{"hosts"},
	Use:     "host",
	PreRun:  MainVulnCmd.PreRun,
	Run:     mainHost,
}

//Add this sub-command 'scan' to the main command
func init() {
	MainVulnCmd.AddCommand(hostCmd)
	hostCmd.SetHelpFunc(helpOutputHost)
	hostCmd.SetUsageFunc(usageOutputHost)
}

func helpOutputHost(cmd *cobra.Command, args []string) {
	printScanHelp()
	return
}
func usageOutputHost(cmd *cobra.Command) error {
	printScanHelp()
	return nil
}

func printHostHelp() {
	fmt.Println(fmt.Sprintf(`

Hosthosthosts
----------------------------->
Output the details of scans.

  `))
	return
}

func mainHost(cmd *cobra.Command, args []string) {
	h := vulnerability.NewHost(VulnConfig)
	h.Execute()
	return
}
