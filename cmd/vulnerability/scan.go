package tio

import (
	"fmt"
	"github.com/spf13/cobra"
	"github.com/whereiskurt/tio-cli/internal/app/tio/vulnerability"
)

//Cobra sub-command
var scanCmd = &cobra.Command{
	Aliases: []string{"scans"},
	Use:     "scan",
	PreRun:  MainVulnCmd.PreRun,
	Run:     mainScan,
}

//Add this sub-command 'scan' to the main command
func init() {
	MainVulnCmd.AddCommand(scanCmd)
	scanCmd.SetHelpFunc(helpOutputScan)
	scanCmd.SetUsageFunc(usageOutputScan)
}

func helpOutputScan(cmd *cobra.Command, args []string) {
	printScanHelp()
	return
}
func usageOutputScan(cmd *cobra.Command) error {
	printScanHelp()
	return nil
}

func printScanHelp() {
	fmt.Println(fmt.Sprintf(`
 _  _  _ __  _
_> (_ (_|| |_>
----------------------------->
Output the details of scans.

  `))
	return
}

func mainScan(cmd *cobra.Command, args []string) {
	s := vulnerability.NewScan(VulnConfig)
	s.Execute()
	return
}
