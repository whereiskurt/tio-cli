package vulnerability

import (
	"fmt"
	"github.com/whereiskurt/tio-cli/internal/pkg/tio"
	"os"
)

type Scan struct {
	Config *tio.VulnerabilityConfig
	Logger *tio.Logger
	Debug  func(string)
	Info   func(string)
	Warn   func(string)
	Error  func(string)

	Output *os.File

	TotalWorkUnits int
	TotalTaskUnits int

	CurrentProgress int
}

func NewScan(config *tio.VulnerabilityConfig) *Scan {
	s := new(Scan)
	s.Config = config

	s.Logger = tio.NewLogger(s.Config.Base)
	s.Debug = s.Logger.Debug
	s.Info = s.Logger.Info
	s.Warn = s.Logger.Warn
	s.Error = s.Logger.Error

	s.Output = config.Base.Output
	return s
}

func (s *Scan) Execute() error {
	s.Debug(fmt.Sprintf("Base.Config:%+v\n", s.Config.Base))
	s.Debug(fmt.Sprintf("Config:%+v\n", s.Config))
	return nil
}
