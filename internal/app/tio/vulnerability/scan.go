package vulnerability

import (
	"fmt"
	"github.com/whereiskurt/tio-cli/internal/pkg/tio"
	"os"
)

type Scan struct {
	Config *tio.VulnerabilityConfig
	Logger *tio.Logger
  Debug func(string)

  Output *os.File

  TotalWorkUnits int
  TotalTaskUnits int

  CurrentProgress int
}

func NewScan(config *tio.VulnerabilityConfig) *Scan {
	s := new(Scan)

	s.Config = config
	s.Logger = tio.NewLogger(s.Config.Base)
  s.Debug = s.Logger.Debug
	s.Output = config.Base.Output
	return s
}

func (s *Scan) Execute() error {
	s.Debug(fmt.Sprintf("Base.Config:%+v\n", s.Config.Base))
	s.Debug(fmt.Sprintf("Config:%+v\n", s.Config))
	return nil
}
